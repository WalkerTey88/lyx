<!DOCTYPE html>
<html lang="zh" translate="no">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>龍運轩ᝰ美食中心 · LYX Food Center</title>
<meta name="color-scheme" content="light">
<style>
/* ============== 红包风主题（红底 / 红按钮白字 / 金线） ============== */
:root{
  --bg:#9b0b14;
  --bg-deep:#7e0810;
  --card:#b70e18;
  --ink:#ffffff;
  --mut:#ffeecf;
  --line:#f1d27a;
  --brand:#f2c84b;
  --brand-ink:#5a3b00;
  --ok:#f2c84b;
  --accent:#ffd86b;
  --shadow:0 10px 28px rgba(0,0,0,.18);
  --ring:0 0 0 3px rgba(242,200,75,.25);
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{margin:0;background:linear-gradient(180deg,var(--bg),var(--bg-deep));color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
a{text-decoration:none;color:inherit}
.wrap{max-width:1200px;margin:20px auto;padding:0 12px 24px}
header{position:sticky;top:0;z-index:9;padding:12px 16px;color:#fff;border-bottom:2px solid var(--line);background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(0,0,0,0));backdrop-filter:saturate(120%) blur(4px)}
.head{display:flex;align-items:center;gap:10px}
header .logo{height:72px;max-width:240px;border-radius:6px;box-shadow:0 2px 8px rgba(0,0,0,.25)}
h1{display:none}
.lang{display:flex;gap:8px;margin-left:auto}
.lang button{padding:6px 12px;border-radius:999px;border:1.5px solid var(--line);background:transparent;color:#fff;font-weight:900;cursor:pointer}
.lang button.active{background:var(--brand);color:var(--brand-ink)}
.grid{display:grid;grid-template-columns:2fr 1fr;gap:16px}
@media (max-width:980px){.grid{grid-template-columns:1fr}}
.panel{background:rgba(255,255,255,.06);border:1.5px solid var(--line);border-radius:16px;box-shadow:var(--shadow)}
.panel h3{margin:0;padding:14px 16px;border-bottom:1.5px dashed var(--line);font-size:16px}
.section{padding:12px 12px 18px}
.controls{display:flex;gap:12px;flex-wrap:wrap;margin:0 6px 10px}
.input{padding:10px;border:1.5px solid var(--line);border-radius:12px;background:rgba(255,255,255,.08);color:#fff;font-weight:900}
.input::placeholder{color:#fff9;font-weight:900}
.note{width:100%;min-height:68px;border:1.5px solid var(--line);border-radius:12px;padding:10px;margin-top:10px;background:rgba(255,255,255,.06);color:#fff;font-weight:900}
.note::placeholder{color:#fff9;font-weight:900}
details{background:linear-gradient(180deg,#ffe38a,#f2c84b);border:1.5px solid #e7c14b;border-radius:14px;margin:10px 0;color:#5a3b00}
summary{list-style:none;cursor:pointer;padding:12px 14px;display:flex;justify-content:space-between;font-weight:900}
summary::marker,summary::-webkit-details-marker{display:none}
summary>span:first-child{color:#5a3b00;font-weight:900}
.cat-sub{color:#5a3b00;font-size:12px;opacity:.95}
.cards{padding:10px;display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
@media(max-width:720px){.cards{grid-template-columns:1fr}}
.item{border:1.5px solid var(--line);border-radius:14px;padding:12px;background:rgba(255,255,255,.06);display:flex;gap:12px}
.qty{min-width:56px;text-align:center;font-weight:900;color:#fff}
.btn{padding:10px 14px;border-radius:12px;font-weight:900;border:1.5px solid #e7c14b;background:linear-gradient(180deg,#ffe38a,#f2c84b);color:var(--brand-ink);cursor:pointer}
.btn:disabled{background:linear-gradient(180deg,#ffe38a,#f2c84b);color:var(--brand-ink);opacity:1;cursor:not-allowed}
.tools .btn{min-width:140px}
.sumrow{display:flex;gap:10px;margin-top:10px}
.sum{border-top:1.5px dashed var(--line);margin-top:10px;padding-top:10px}
.kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:12px}
.kpi{border:1.5px solid var(--line);border-radius:12px;padding:10px;background:rgba(255,255,255,.06);text-align:center}
.kpi b{display:block;font-size:18px;color:#fff}
.hidden{display:none}
</style>
</head>
<body>
<header>
  <div class="head">
    <img src="logo.png" class="logo" onerror="this.style.display='none'">
    <h1><span id="title-main"></span><small id="title-sub"></small></h1>
    <div class="lang">
      <button id="btn-zh" class="active">中文</button>
      <button id="btn-en">English</button>
      <button id="btn-vi">Tiếng Việt</button>
    </div>
  </div>
</header>

<div class="wrap grid">
  <section class="panel">
    <h3 id="panel-order">点餐 / Order</h3>
    <div class="section">
      <div class="controls">
        <label id="label-table">桌号</label>
        <input id="tableNo" class="input" placeholder="A1">
        <label><input type="checkbox" id="takeaway"><span id="takeaway-label">外带</span></label>
      </div>
      <details><summary><span id="sum-wonton">龍兴记ᝰ云吞面</span><span class="cat-sub" id="tip-wonton">点击展开/收起</span></summary><div class="cards" id="cat-wonton"></div></details>
      <details><summary><span id="sum-drinks">饮料</span><span class="cat-sub" id="tip-drinks">全部饮料冰+RM0.20</span></summary><div class="cards" id="cat-drinks"></div></details>
      <details><summary><span id="sum-auntie">婶婶档</span><span class="cat-sub" id="tip-auntie">点击展开/收起</span></summary><div class="cards" id="cat-auntie"></div></details>
      <details><summary><span id="sum-gx">广西卷筒粉</span><span class="cat-sub" id="tip-gx">点击展开/收起</span></summary><div class="cards" id="cat-guangxi"></div></details>
    </div>
  </section>

  <aside class="panel sticky">
    <h3 id="panel-cart">订单 / Cart</h3>
    <div id="cart" class="section"></div>
    <div class="section">
      <label id="note-label">备注</label>
      <textarea id="note" class="note" placeholder="例如：少甜 / 少冰 / 加辣"></textarea>
      <div class="sumrow">
        <button class="btn" id="btn-print">打印小票</button>
        <button class="btn" id="btn-done">完成并统计</button>
      </div>
      <div class="kpis">
        <div class="kpi"><span id="kpi-orders-title">订单笔数</span><b id="kpi-orders">0</b></div>
        <div class="kpi"><span id="kpi-items-title">售出件数</span><b id="kpi-items">0</b></div>
        <div class="kpi"><span id="kpi-sales-title">销售金额</span><b id="kpi-sales">RM 0.00</b></div>
      </div>
      <div class="tools">
        <button class="btn" id="btn-view">查看明细</button>
        <button class="btn" id="btn-cat">分类统计</button>
        <button class="btn" id="btn-csv">导出 CSV</button>
        <button class="btn" id="btn-del">删单</button>
      </div>
    </div>
  </aside>
</div>

<div id="print-area" class="hidden"></div>

<script>
/* ===== 这里保留你原有的脚本：I18N、菜单数据、renderAll、购物车、统计、云端、打印、导出、删除等 ===== */
/* …… 你的原始大段脚本 …… */

/* === 关键修复：把所有函数挂到 window，保证 WebViewer 可调用 === */
Object.assign(window,{
  inc,dec,printReceipt,finishAndSend,viewToday,viewByCategory,exportCSV,deleteWithPwd,setLang
});

/* === 初始化事件绑定 === */
function initBindings(){
  document.getElementById('btn-zh').onclick=()=>setLang('zh');
  document.getElementById('btn-en').onclick=()=>setLang('en');
  document.getElementById('btn-vi').onclick=()=>setLang('vi');
  document.getElementById('btn-print').onclick=printReceipt;
  document.getElementById('btn-done').onclick=finishAndSend;
  document.getElementById('btn-view').onclick=viewToday;
  document.getElementById('btn-cat').onclick=viewByCategory;
  document.getElementById('btn-csv').onclick=exportCSV;
  document.getElementById('btn-del').onclick=deleteWithPwd;
}
document.addEventListener("DOMContentLoaded",()=>{renderAll();initBindings();});
</script>
</body>
</html>
